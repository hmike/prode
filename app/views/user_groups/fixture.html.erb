<div ng-controller="UserGroupsCtrl" ng-init="init(<%= @user_group.id %>)">

<%- model_class = UserGroup -%>
<!-- <div class="league-banner">
	<img src="http://img.fifa.com/images/fwc/2014/brand/header.es.png?v=130439605604123628" />
</div> -->
<div class="page-header">
	<% if (@user_group.league.name == "Torneo Final 2014") %>
		<div class="league-avatar"><%= image_tag ('logos/afa.png') %></div>
	<% else %>
		<div class="league-avatar"><%= image_tag ('logos/fifa_wc2014.png') %></div>
	<% end %>
	<h1><%= @user_group.name %></h1>
	<h3><%= @user_group.league.name %></h3>
</div>

<!-- Show Teams by league date -->
<% @league_groups.each do |k,group_teams| %>
	<table class="table table-hover tbl-standing">
		<caption class="table-title"><%= (k.nil?) ? "" : "Grupo #{k.upcase}" %></caption>
		<thead>
			<tr>
				<th class="col-md-1"></th>
				<th class="col-md-3 tbl-teamname">Nombre</th>
				<th class="col-md-1">PJ</th>
				<th class="col-md-1">PG</th>
				<th class="col-md-1">PP</th>
				<th class="col-md-1">PE</th>
				<th class="col-md-1">GF</th>
				<th class="col-md-1">GC</th>
				<th class="col-md-1">D</th>
				<th class="col-md-1">Pts</th>
			</tr>
		</thead>
		<tbody>
			<% position = 1 %>
			<% group_teams.each do |league_team| %>
				<tr>
					<td><%= position %></td>
					<td class="tbl-teamname tbl-team-<%= league_team.team.code.downcase %>">
						<% if (league_team.team.avatar?) %>
						<%= image_tag league_team.team.avatar(:thumb) %>
						<% end %>
						<label><%= league_team.team.name %></label>
					</td>
					<td><%= league_team.matches_played %></td>
					<td><%= league_team.matches_won %></td>
					<td><%= league_team.matches_lost %></td>
					<td><%= league_team.matches_tied %></td>
					<td><%= league_team.goals_scored %></td>
					<td><%= league_team.goals_against %></td>
					<% diff = (league_team.goals_scored.to_i - league_team.goals_against.to_i) %>
					<td><%= diff %></td>
					<td><%= league_team.points %></td>
				</tr>
				<% position+=1 %>
			<% end %>
		</tbody>
	</table>
<% end %>

<div ng-repeat="league_date in matches" ng-cloak class="ng-cloak">
<h2>Fixture</h2>

<table class="table tbl-fixture">
	<caption class="table-title">Fecha {{league_date[1].league_date}}</caption>
	<thead>
		<tr>
			<th class="col-md-1"></th>
			<th class="col-md-2"></th>
			<th class="col-md-3"></th>
			<th class="col-md-3"></th>
			<th class="col-md-3"></th>
		</tr>
	</thead>
	<tbody>
		<tr ng-repeat="match in league_date">
			<td class="tbl-date">
				<span>{{match.date | date: 'EEE d MMM. yyyy'}}</span>
				<span>Fecha {{match.league_date}}</span>
			</td>
			<!-- <td class="tbl-score">{{match.date.strftime("%k:%M")}}</td> -->
			<td class="tbl-score">{{match.date | date: 'HH:mm'}}</td>
			<td class="tbl-teamname tbl-teamlocal tbl-team-{{match.local_team.team.code | lowercase}}">
				<div>
					<button class="btn-press" ng-class="{'active' : (my_bets[match.id].bet==1)}" ng-model="my_bets[match.id].bet" value="1" ng-click='betMatch(<%= @user_group.id %>, match.id, 1)'>
						<img ng-src="/assets/teams/afa/{{match.local_team.team.code | lowercase}}_medium.png" ></img>
						<label>{{match.local_team.team.name}}</label>
					</button>
				</div>
			</td>
			<td class="tbl-tied">
				<div>
					<button class="btn-press" ng-class="{'active' : (my_bets[match.id].bet==0)}" ng-model="my_bets[match.id].bet" value="0" ng-click='betMatch(<%= @user_group.id %>, match.id, 0)'>
						<label>EMPATE<label>
					</button>
				</div>
			</td>
			<td class="tbl-teamname tbl-teamaway tbl-team-{{match.away_team.team.code | lowercase}}">
				<div>
					<button class="btn-press" ng-class="{'active' : (my_bets[match.id].bet==2)}" ng-model="my_bets[match.id].bet" value="2" ng-click='betMatch(<%= @user_group.id %>, match.id, 2)'>
						<img ng-src="/assets/teams/afa/{{match.away_team.team.code | lowercase}}_thumb.png" ></img>
						<label>{{match.away_team.team.name}}</label>
					</button>
				</div>
			</td>
		</tr>
	</tbody>
</table>

</div>